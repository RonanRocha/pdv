<Window x:Class="EmissorNF.Cliente.Telas.Caixa.WFVenda"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:EmissorNF.Cliente.Telas.Caixa"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        TextElement.FontWeight="Regular"
        TextElement.FontSize="13"
        TextOptions.TextFormattingMode="Ideal" 
        TextOptions.TextRenderingMode="Auto"        
        Background="{DynamicResource MaterialDesignPaper}"
        FontFamily="{DynamicResource MaterialDesignFont}"
        mc:Ignorable="d"
        WindowState="Maximized"
        Title="Venda" Height="768" Width="1360">
    <Grid>

        <Grid.RowDefinitions>
            <RowDefinition Height="50"></RowDefinition>
            <RowDefinition Height="6*"></RowDefinition>
        </Grid.RowDefinitions>


        <materialDesign:ColorZone  Grid.Row="0" Mode="PrimaryMid" Padding="5">
            <StackPanel Orientation="Horizontal">
                <ToggleButton Style="{DynamicResource MaterialDesignHamburgerToggleButton}" />
                <TextBlock VerticalAlignment="Center" Margin="16 0 0 0" Text="TOUTI UNIDADE SP" />
            </StackPanel>
        </materialDesign:ColorZone>

        <Grid Grid.Row="1">

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"></ColumnDefinition>
                <ColumnDefinition Width="4*"></ColumnDefinition>
                <ColumnDefinition Width="4*"></ColumnDefinition>
            </Grid.ColumnDefinitions>

            <Grid Margin="10,10,0,10"  Grid.Column="0" >
                <materialDesign:Card materialDesign:ShadowAssist.ShadowDepth="Depth1" Padding="10">
                    <StackPanel>
                        <Button Margin="10" Command="{Binding IniciarVendaCommand}" Cursor="Hand">Nova Venda</Button>
                        <TextBox Padding="10" materialDesign:HintAssist.Hint="CPF DO CLIENTE"  materialDesign:TextFieldAssist.HasClearButton="True" Style="{StaticResource MaterialDesignOutlinedTextBox}" Margin="10" ></TextBox>
                        <CheckBox IsChecked="{Binding CpfNota, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" Style="{StaticResource MaterialDesignUserForegroundCheckBox}" Content="CPF NA NOTA" Margin="10" />
                        <CheckBox IsChecked="{Binding EnviarEmail, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" Style="{StaticResource MaterialDesignUserForegroundCheckBox}" Content="ENVIAR NOTA" Margin="10" />
                    </StackPanel>
                </materialDesign:Card>
            </Grid>

            <Grid Margin="10,10,0,10"  Grid.Column="1">
                <materialDesign:Card materialDesign:ShadowAssist.ShadowDepth="Depth1" Padding="10">

                    <Grid>

                        <Grid.RowDefinitions>
                            <RowDefinition Height="1*"></RowDefinition>
                            <RowDefinition Height="9*"></RowDefinition>
                        </Grid.RowDefinitions>

                        <Grid Grid.Row="0">

                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"></ColumnDefinition>
                                <ColumnDefinition Width="8*"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBox Padding="10" Text="{Binding Quantidade, UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}" PreviewTextInput="NumberValidationTextBox"  materialDesign:HintAssist.Hint="QUANTIDADE"  materialDesign:TextFieldAssist.HasClearButton="True" Style="{StaticResource MaterialDesignOutlinedTextBox}" Margin="10" Cursor="IBeam" ></TextBox>
                            </StackPanel>

                            <StackPanel Grid.Column="1">
                                <TextBox Padding="10"  Text="{Binding Busca, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" materialDesign:HintAssist.Hint="BUSCA POR CÓDIGO OU DESCRIÇÃO DO PRODUTO"  materialDesign:TextFieldAssist.HasClearButton="True" Style="{StaticResource MaterialDesignOutlinedTextBox}" Margin="10" Cursor="IBeam" >
                                    <TextBox.InputBindings>
                                        <KeyBinding 
                                            Key="Return" 
                                            Command="{Binding BuscarProdutoCommand}" 
                                            CommandParameter="{Binding Path=Text, RelativeSource={RelativeSource AncestorType={x:Type TextBox}}}" />
                                    </TextBox.InputBindings>
                                </TextBox>
                            </StackPanel>

                        </Grid>
                    </Grid>
                </materialDesign:Card>
            </Grid>

            <Grid Margin="10" Grid.Column="2">
                <materialDesign:Card materialDesign:ShadowAssist.ShadowDepth="Depth1" Padding="10">
                    <Grid>

                        <Grid.RowDefinitions>
                            <RowDefinition Height="60"></RowDefinition>
                            <RowDefinition Height="6*"></RowDefinition>
                            <RowDefinition Height="3*"></RowDefinition>
                        </Grid.RowDefinitions>

                        <Grid  Grid.Row="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="6*"></ColumnDefinition>
                                <ColumnDefinition Width="3*"></ColumnDefinition>
                                <ColumnDefinition Width="3*"></ColumnDefinition>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0">
                                <ComboBox  Padding="10"  x:Name="CmbVendedores"
                        Style="{StaticResource MaterialDesignOutlinedComboBox}"
                       materialDesign:TextFieldAssist.HasClearButton="True"
                        Margin="10"
                        ItemsSource="{Binding Vendedores, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"                 
                        materialDesign:HintAssist.Hint="VENDEDOR"
                        DisplayMemberPath="Nome"
                        SelectedValue="{Binding Vendedor, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                         />
                            </StackPanel>

                            <StackPanel Grid.Column="1">
                                <TextBox Padding="10"  materialDesign:HintAssist.Hint="Desconto"  materialDesign:TextFieldAssist.HasClearButton="True" Style="{StaticResource MaterialDesignOutlinedTextBox}" Margin="10" ></TextBox>
                            </StackPanel>

                            <StackPanel Grid.Column="2">
                                <TextBox Padding="10"  materialDesign:HintAssist.Hint="Acrescimo"  materialDesign:TextFieldAssist.HasClearButton="True" Style="{StaticResource MaterialDesignOutlinedTextBox}" Margin="10" ></TextBox>
                            </StackPanel>
                        </Grid>

                        <Grid Grid.Row="1" >
                            
                                <DataGrid   Grid.Row="2" Margin="10"
                      x:Name="GridProdutos" 
                      AutoGenerateColumns="False"   
                      SelectionUnit="FullRow"                     
                      ItemsSource="{Binding Venda.Produtos, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                      SelectionMode="Single"
                      CanUserReorderColumns="True"
                      CanUserAddRows="False" 
                      CanUserResizeRows="True"  >
                                    <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding Produto.Codigo}" IsReadOnly="True" Header="CODIGO"/>
                                    <DataGridTextColumn Binding="{Binding Produto.Descricao}" IsReadOnly="True" Header="DESCRICAO"/>
                                    <DataGridTextColumn Binding="{Binding Quantidade}" IsReadOnly="True" Header="QUANTIDADE"/>
                                    <DataGridTextColumn Binding="{Binding Total, StringFormat=C}" IsReadOnly="True" Header="TOTAL"/>
                                    <DataGridTextColumn Binding="{Binding Subtotal, StringFormat=C}" IsReadOnly="True" Header="SUBTOTAL"/>
                                        <DataGridTemplateColumn>
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                <Button HorizontalAlignment="Right" CommandParameter="{Binding}" Command="{Binding DataContext.RemoverProdutoVendaCommand, RelativeSource= {RelativeSource FindAncestor,AncestorType={x:Type DataGrid}}}">
                                                        <materialDesign:PackIcon Kind="TrashCanOutline" />

                                                    </Button>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                           
                        </Grid>

                        <Grid Grid.Row="2">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="9*"></RowDefinition>
                                <RowDefinition Height="70"></RowDefinition>
                            </Grid.RowDefinitions>

                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Grid.Row="1" Margin="10">
                                <Button Command="{Binding IniciarPagamentosCommand}"> FECHAR VENDA</Button>
                            </StackPanel>
                            
                        </Grid>

                    </Grid>
                </materialDesign:Card>
            </Grid>

        </Grid>
        
        
        

    </Grid>
</Window>
